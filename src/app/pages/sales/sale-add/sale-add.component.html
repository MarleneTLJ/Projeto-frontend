<div class="container">
  <form class="form-content" [formGroup]="saleForm">
    <mat-card class="mat-elevation-z0 outlined-card">
      <mat-card-title class="card-header">
        Não esqueça de verificar 2x antes de registrar a venda!
      </mat-card-title>
      <!-- INÍCIO: Form de cadastro -->
      <div class="alert alert-danger" *ngIf="error">
        <p>{{ error }}</p>
      </div>
      <mat-card-content>
        <div class="card-content" formGroupName="clientForm">
          <!-- INÍCIO: Nome -->
          <mat-form-field>
            <mat-label>Nome</mat-label>
            <input
              matInput
              minlength="3"
              maxlength="50"
              placeholder="Nome"
              formControlName="name"
              name="name"
              required
            />
            <mat-error>
              <div *ngIf="name.invalid">
                <div *ngIf="name.errors?.['required']">Nome é obrigatório</div>
                <div *ngIf="name.errors?.['minlength']">
                  Nome deve ter no mínimo 3 caracteres
                </div>
                <div *ngIf="name.errors?.['maxlength']">
                  Nome deve ter no máximo 50 caracteres
                </div>
              </div>
            </mat-error>
          </mat-form-field>
          <!-- FIM: Nome -->
          <!-- INÍCIO: Sobrenome -->
          <mat-form-field>
            <mat-label>Sobrenome</mat-label>
            <input
              matInput
              minlength="3"
              maxlength="255"
              placeholder="Sobrenome"
              formControlName="surname"
              name="surname"
              required
            />
            <mat-error>
              <div *ngIf="surname.invalid">
                <div *ngIf="surname.errors?.['required']">
                  Sobrenome é obrigatório
                </div>
                <div *ngIf="surname.errors?.['minlength']">
                  Sobrenome deve ter no mínimo 3 caracteres
                </div>
                <div *ngIf="surname.errors?.['maxlength']">
                  Sobrenome deve ter no máximo 255 caracteres
                </div>
              </div>
            </mat-error>
          </mat-form-field>
          <!-- FIM: Sobrenome -->
          <!-- INÍCIO: Email -->
          <mat-form-field>
            <mat-label>E-mail</mat-label>
            <input
              matInput
              formControlName="email"
              placeholder="E-mail"
              name="email"
              required
            />
            <mat-error *ngIf="email.invalid && email.hasError('email')">
              Digite um e-mail válido
            </mat-error>
          </mat-form-field>
          <!-- FIM: Email -->
          <!-- INÍCIO: CPF -->
          <mat-form-field
            [hintLabel]="cpf.invalid ? 'Digite apenas números' : ' '"
          >
            <mat-label>CPF</mat-label>
            <input
              type="text"
              matInput
              maxlength="11"
              formControlName="cpf"
              placeholder="CPF"
              name="cpf"
              required
            />
            <mat-error>
              <div *ngIf="cpf.invalid">
                <div *ngIf="cpf.errors?.['required']">CPF é obrigatório</div>
                <div *ngIf="cpf.errors?.['cpfInvalido']">
                  Digite um CPF válido
                </div>
              </div>
            </mat-error>
          </mat-form-field>
          <!-- FIM: CPF -->
        </div>
        <!-- INÍCIO: Valor Pago -->
        <mat-form-field>
          <mat-label>Valor Pago</mat-label>
          <input
            matInput
            placeholder="Valor Pago"
            formControlName="value_paid"
            name="value_paid"
            type="number"
            required
          />
          <mat-error>
            <div *ngIf="value_paid.invalid">
              <div *ngIf="value_paid.errors?.['required']">
                Valor Pago é obrigatório
              </div>
            </div>
          </mat-error>
        </mat-form-field>
        <!-- FIM: Valor Pago -->
      </mat-card-content>
      <mat-card-actions>
        <button mat-stroked-button color="primary" (click)="addCourse()">
          Add curso
        </button>
      </mat-card-actions>
    </mat-card>
    <mat-card class="mat-elevation-z0 outlined-card" formArrayName="courses">
      <div
        class="card-content"
        *ngFor="let course of courses.controls; let i = index"
      >
        <div [formGroupName]="i">
          <!-- INÍCIO: Título -->
          <mat-form-field>
            <mat-label>Título</mat-label>
            <input
              matInput
              minlength="3"
              maxlength="255"
              placeholder="Título"
              formControlName="title"
              name="title"
              required
            />
            <mat-error>
              <div *ngIf="title.invalid">
                <div *ngIf="title.errors?.['required']">
                  Título é obrigatório
                </div>
                <div *ngIf="title.errors?.['minlength']">
                  Título deve ter no mínimo 3 caracteres
                </div>
                <div *ngIf="title.errors?.['maxlength']">
                  Título deve ter no máximo 255 caracteres
                </div>
              </div>
            </mat-error>
          </mat-form-field>
          <!-- FIM: Título -->
          <!-- INÍCIO: Carga Horária -->
          <mat-form-field>
            <mat-label>Carga Horária</mat-label>
            <input
              matInput
              placeholder="Carga Horária"
              formControlName="workload"
              name="workload"
              type="number"
              required
            />
            <mat-error>
              <div *ngIf="workload.invalid">
                <div *ngIf="workload.errors?.['required']">
                  Carga Horária é obrigatório
                </div>
              </div>
            </mat-error>
          </mat-form-field>
          <!-- FIM: Carga Horária -->
          <!-- INÍCIO: Preço -->
          <mat-form-field>
            <mat-label>Preço</mat-label>
            <input
              matInput
              currencyMask
              [options]="{
                prefix: 'R$ ',
                thousands: '.',
                decimal: ',',
                align: 'left'
              }"
              placeholder="Preço"
              formControlName="price"
              name="price"
              required
            />
            <mat-error>
              <div *ngIf="price.invalid">
                <div *ngIf="price.errors?.['required']">
                  Preço é obrigatório
                </div>
              </div>
            </mat-error>
          </mat-form-field>
          <!-- FIM: Preço -->
          <!-- INÍCIO: Descrição -->
          <mat-form-field>
            <mat-label>Descrição</mat-label>
            <textarea
              matInput
              rows="8"
              cols="30"
              placeholder="Descrição"
              formControlName="description"
              name="description"
              required
            ></textarea>
            <mat-error>
              <div *ngIf="description.invalid">
                <div *ngIf="description.errors?.['required']">
                  Descrição é obrigatório
                </div>
              </div>
            </mat-error>
          </mat-form-field>
          <!-- FIM: Descrição -->
        </div>
      </div>
    </mat-card>
    <mat-card-actions>
      <a class="spacing" mat-stroked-button (click)="goBack()">Voltar</a>
      <button
        class="spacing"
        mat-flat-button
        color="primary"
        (click)="addSale()"
      >
        Salvar
      </button>
    </mat-card-actions>
  </form>
  <!-- FIM: Form de cadastro -->
</div>
